(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3245],{46313:function(e){function n(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}n.keys=function(){return[]},n.resolve=n,n.id=46313,e.exports=n},88143:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return M}});var r=t(50029),a=t(87794),s=t.n(a),c=t(42699),i=t(21608),u=t(31555),o=t(93680),l=t(50711),d=t(5152),p=t(92987),f=t(67294),h=t(3782),x=JSON.parse('{"Mt":[{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Minted","type":"event"},{"inputs":[{"internalType":"address","name":"_token","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_uri","type":"string"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),v=t(18457),m=function(e,n){var t=x.Mt;return b(e,n,t)},b=function(e,n,t){var r=new v.ethers.providers.Web3Provider(n).getSigner();return new v.ethers.Contract(e,t,r).connect(r)},k=function(){var e=(0,r.Z)(s().mark((function e(n,t,a){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,r.Z)(s().mark((function e(c,i){var u,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{u=new v.ethers.providers.Web3Provider(n),o=0,u.on("block",function(){var e=(0,r.Z)(s().mark((function e(n){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return++o>a&&(u.removeAllListeners("block"),c(!1)),e.next=4,u.getTransactionReceipt(t);case 4:(r=e.sent)&&r.blockNumber&&(u.removeAllListeners("block"),c(!0));case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}catch(l){console.log("waiting for transaction rejected with error",l),i(l)}case 1:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),g=t(85893),w={queuedTx:null,pendingTx:[],completedTx:null,warning:null,noOperations:0,addNewQueuedTx:function(e,n,t){return null},convertQueuedToPending:function(e,n,t){return null},doAnOperation:function(){return null},isBusy:function(){return null}},j=f.createContext(w),y=t(9669),Z=t.n(y),C=t(72132),N=t(58001),_=t(27531),A=t(42660),T=((0,d.default)((function(){return t.e(9257).then(t.t.bind(t,34210,23)).then((function(e){return e.default}))}),{ssr:!1,loadableGenerated:{webpack:function(){return[34210]}}}),_.v.NFT_STORAGE_TOKEN),I=new A.j3({token:T}),S="pinned",O="queued",E=function(){var e=(0,r.Z)(s().mark((function e(n){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.storeBlob(new Blob([n]));case 2:return t=e.sent,e.next=5,I.status(t);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=function(e){var n=e.pr,t=_.v.IPFS_GATEWAY,a=(0,p.Os)(),d=(0,l.Eu)(),x=(0,f.useState)(!1),v=x[0],b=x[1],w=(0,f.useState)(void 0),y=w[0],A=w[1],T=(0,f.useState)(void 0),I=T[0],M=T[1],H=(0,f.useState)(void 0),P=H[0],R=H[1],B=(0,f.useState)([]),U=B[0],J=B[1],D=(0,f.useState)(!1),K=D[0],W=D[1],F=(0,f.useState)(!1),q=F[0],G=F[1],L=(0,f.useState)(""),$=L[0],z=L[1],Q=(0,f.useContext)(j),X=_.v.POPR_ADDRESS,Y=_.v.TOKEN_ADDRESS,V=_.v.TOKEN_TRACKER,ee=function(){var e=(0,r.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.account){e.next=6;break}return e.next=3,(0,N.J8)(a.account);case 3:return n=e.sent,J(n&&n!==[]?n:[]),e.abrupt("return",n);case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,f.useEffect)((function(){var e=function(){var e=(0,r.Z)(s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z().post(_.v.IMAGE_API_URL,n);case 2:t=e.sent,z(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();_.v.IMAGE_API_URL?e():(0,C.Am)("No image url api selected"),M(void 0),G(!1)}),[null===n||void 0===n?void 0:n.node_id]),(0,f.useEffect)((function(){ee()}),[a.account,K]);var ne=function(){if(K)return!0;var e=null===U||void 0===U?void 0:U.find((function(e){return e.pullRequestId===(null===n||void 0===n?void 0:n.node_id)}));return!!e&&(M(e.jsonHash),A(e.nftHash),R(e.tokenId),!0)},te=function(e){if(e){var n=e.length;return"".concat(e.substring(0,10),"...").concat(e.substring(n-10,n))}return""},re=function(e){return e?e.length<=10?e:te(e):""},ae=function(e){var n=e.events.find((function(e){return"Minted"===e.event}));return{tokenId:n.args.tokenId.toNumber(),address:n.args.to}},se=function(){var e=(0,r.Z)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={walletAddress:d.walletAddress,githubUsername:d.login,jsonHash:t.jsonHash,nftHash:t.nftHash,contractAddress:t.contractAddress,tokenId:t.tokenId,pullRequestId:null===n||void 0===n?void 0:n.node_id},e.next=3,(0,N.wJ)(r);case 3:return e.next=5,ne();case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ce=function(){var e=(0,r.Z)(s().mark((function e(){var r,c,i,u,o,l,d,p,f,h,x;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.isConnected()){e.next=61;break}return e.prev=1,(0,C.Am)("Running Pre-Mint check..."),e.next=5,ee();case 5:if(!ne()){e.next=8;break}return C.Am.warning("Nft for this PR already minted"),e.abrupt("return");case 8:return W(!0),G(!0),(0,C.Am)("Uploading Nft to IPFS..."),r=$,e.next=14,E(r);case 14:if((c=e.sent).pin.status!==O&&c.pin.status!==S){e.next=52;break}return(0,C.Am)("Uploading Metadata to IPFS..."),i={name:"Proof of Pull Request",description:n.title,image:"".concat(t,"/").concat(c.cid),external_url:n.html_url,attributes:n},e.next=20,E(i);case 20:if((u=e.sent).pin.status!==O&&u.pin.status!==S){e.next=52;break}return(0,C.Am)("Minting Nft on the blockchain..."),o="".concat(t,"/").concat(u.cid),A(c.cid),M(u.cid),l=m(X,a.ethereum),d=l.mint(o),Q.addNewQueuedTx(d,"Minting Proof of Pull Request",{}),e.next=31,d;case 31:return p=e.sent,e.next=34,p.wait(1);case 34:return f=e.sent,e.next=37,k(a.ethereum,f.transactionHash,_.v.TX_WAIT_BLOCK_COUNT);case 37:if(e.sent){e.next=42;break}C.Am.error("Transaction not found after ".concat(_.v.TX_WAIT_BLOCK_COUNT," blocks")),e.next=50;break;case 42:if(h=ae(f),x=h.tokenId,h.address===a.account){e.next=45;break}throw Error("Account and Wallet Address Minted not the same");case 45:return R(x),C.Am.success("NFT Minted Successfully. Check your wallet for the token"),(0,C.Am)("Cleaning up..."),e.next=50,se({nftHash:c.cid,jsonHash:u.cid,contractAddress:X,tokenId:x});case 50:W(!1),G(!0);case 52:e.next=59;break;case 54:e.prev=54,e.t0=e.catch(1),console.log(e.t0),W(!1),G(!1);case 59:e.next=63;break;case 61:null===a||void 0===a||a.reset(),b(!0);case 63:case"end":return e.stop()}}),e,null,[[1,54]])})));return function(){return e.apply(this,arguments)}}();return(0,g.jsxs)(c.Z,{show:e.show,onHide:e.onHide,centered:!0,size:"lg",children:[(0,g.jsx)(c.Z.Header,{closeButton:!0,children:(0,g.jsx)(c.Z.Title,{id:"contained-modal-title-vcenter",children:"Pull Request Details"})}),(0,g.jsxs)(c.Z.Body,{children:[(0,g.jsxs)(i.Z,{children:[(0,g.jsx)(u.Z,{xs:2,children:"Title:"}),(0,g.jsx)(u.Z,{children:null===n||void 0===n?void 0:n.title})]}),(0,g.jsx)("hr",{}),(0,g.jsxs)(i.Z,{children:[(0,g.jsx)(u.Z,{xs:2,children:"Body:"}),(0,g.jsx)(u.Z,{children:null===n||void 0===n?void 0:n.body})]}),(0,g.jsx)("hr",{}),(0,g.jsxs)(i.Z,{children:[(0,g.jsx)(u.Z,{xs:2,children:"Url"}),(0,g.jsx)(u.Z,{children:(0,g.jsx)("a",{href:null===n||void 0===n?void 0:n.html_url,target:"_blank",rel:"noreferrer",children:null===n||void 0===n?void 0:n.html_url})})]}),(0,g.jsx)("hr",{}),(0,g.jsxs)(i.Z,{children:[a.account&&(0,g.jsxs)(u.Z,{xs:12,style:{marginBottom:"20px"},children:["Wallet: ",a.account]}),(0,g.jsx)(u.Z,{xs:12,style:{marginBottom:"20px"},children:(0,g.jsx)(o.Z,{variant:"success",onClick:function(){return ce()},disabled:q,children:a.isConnected()?"Mint NFT":"Connect Wallet"})}),(0,g.jsx)(u.Z,{xs:6,children:(0,g.jsx)("img",{alt:"NFT Image",src:$,width:"350",height:"350"})}),(0,g.jsxs)(u.Z,{xs:6,children:[K&&(0,g.jsx)("div",{className:"text-center",children:(0,g.jsx)("div",{className:"spinner-border",role:"status",style:{width:"6rem",height:"6rem"}})}),I&&!K&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("p",{children:[(0,g.jsx)("span",{children:"Nft Hash: "}),(0,g.jsx)("a",{href:"".concat(t,"/").concat(y),children:re(y)})]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("span",{children:"Json Hash: "}),(0,g.jsx)("a",{href:"".concat(t,"/").concat(I),children:re(I)})]}),(0,g.jsxs)("p",{children:[(0,g.jsx)("span",{children:"Contract: "}),(0,g.jsx)("a",{href:"".concat(V,"/").concat(Y),children:te(Y)})]}),(0,g.jsx)("p",{children:(0,g.jsxs)("span",{children:["Minted Token Id: ",P]})})]})]})]}),(0,g.jsx)(h.default,{open:v,setOpen:b})]}),(0,g.jsx)(c.Z.Footer,{children:(0,g.jsx)(o.Z,{onClick:e.onHide,children:"Close"})})]})}},3782:function(e,n,t){"use strict";t.r(n);var r=t(50029),a=t(87794),s=t.n(a),c=t(67294),i=t(42699),u=t(21608),o=t(31555),l=t(93680),d=t(92987),p=t(27531),f=t(85893);n.default=function(e){var n=(0,d.Os)(),t=function(){var e=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:p.v.CHAIN_ID}]});case 3:e.next=16;break;case 5:if(e.prev=5,e.t0=e.catch(0),4902!==e.t0.code){e.next=16;break}return e.prev=8,e.next=11,n.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:p.v.CHAIN_ID,chainName:"Gnosis Chain",nativeCurrency:{name:"Gnosis",symbol:"xDAI",decimals:18},rpcUrls:["https://rpc.xdaichain.com"],blockExplorerUrls:["https://blockscout.com/xdai/mainnet"],iconUrls:[""]}]});case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(8),console.log("Did not add network");case 16:case"end":return e.stop()}}),e,null,[[0,5],[8,13]])})));return function(){return e.apply(this,arguments)}}();c.useEffect((function(){n.isConnected&&"connected"===n.status&&n.chainId!==+p.v.CHAIN_ID&&t()}),[n.status]);var a=function(){(0,e.setOpen)(!1)},h=e.open,x=[{name:"Metamask",image:"img/metamask.png",onClick:function(){n.connect("provided"),a()}},{name:"Wallet Connect",image:"img/walletconnect.png",onClick:function(){n.connect("walletconnect"),a()}},{name:"Binance Wallet",image:"img/bsc.png",onClick:function(){n.connect("bsc"),a()}},{name:"Torus",image:"img/torus.png",onClick:function(){n.connect("torus"),a()}}];return(0,f.jsx)(c.Fragment,{children:(0,f.jsxs)(i.Z,{show:h,onHide:a,children:[(0,f.jsx)(i.Z.Header,{closeButton:!0,children:(0,f.jsx)(i.Z.Title,{children:"Select Wallet"})}),(0,f.jsx)(i.Z.Body,{children:(0,f.jsx)(u.Z,{children:(0,f.jsx)(o.Z,{xs:12,children:(0,f.jsx)(u.Z,{style:{marginBottom:"10px"},children:x.map((function(e){return(0,f.jsx)(o.Z,{xs:"6",style:{marginTop:"10px",marginBottom:"10px"},children:(0,f.jsx)("div",{className:"d-grid gap-2",children:(0,f.jsx)(l.Z,{className:"wallet-button-image",variant:"warning",size:"lg",onClick:e.onClick,children:e.name})})},e.name)}))})})})}),(0,f.jsx)(i.Z.Footer,{children:(0,f.jsx)(l.Z,{variant:"secondary",onClick:a,children:"Close"})})]})})}},58001:function(e,n,t){"use strict";t.d(n,{wJ:function(){return u},J8:function(){return o},C9:function(){return l},Zy:function(){return d}});var r=t(50029),a=t(87794),s=t.n(a),c=t(80628),i=new c._W("https://siasky.net",{onUploadProgress:function(e,n){n.loaded,n.total;console.info("Progress ".concat(Math.round(100*e),"%"))}}),u=function(){var e=(0,r.Z)(s().mark((function e(n){var t,r,a,u,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,c.$M)(n.walletAddress),r=t.privateKey,a=t.publicKey,u=n.walletAddress,e.prev=3,e.next=6,i.db.getJSON(a,u);case 6:o=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(3);case 11:return o.data||(o.data=[]),o.data.push(n),e.next=15,i.db.setJSON(r,u,o.data);case 15:return e.abrupt("return",!0);case 18:e.prev=18,e.t1=e.catch(0),console.log(e.t1);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[0,18],[3,9]])})));return function(n){return e.apply(this,arguments)}}(),o=function(){var e=(0,r.Z)(s().mark((function e(n){var t,r,a,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=(0,c.$M)(n),r=t.publicKey,a=n,e.next=5,i.db.getJSON(r,a);case 5:return u=e.sent,e.abrupt("return",u.data);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,r.Z)(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,c.$M)("this is a seed"),t=n.publicKey,"api-list",e.next=5,i.db.getJSON(t,"api-list");case 5:return r=e.sent,console.log(r),e.abrupt("return",r.data);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,r.Z)(s().mark((function e(n,t){var r,a,u,o,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,c.$M)("this is a seed"),a=r.privateKey,u=r.publicKey,o="api-list",e.next=5,i.db.setJSON(a,o,[]);case 5:return e.prev=5,e.next=8,i.db.getJSON(u,o);case 8:l=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:return l.data||(l.data=[]),l.data.push({name:n,url:t}),e.next=17,i.db.setJSON(a,o,l.data);case 17:return e.abrupt("return",!0);case 20:e.prev=20,e.t1=e.catch(0),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[0,20],[5,11]])})));return function(n,t){return e.apply(this,arguments)}}()},50711:function(e,n,t){"use strict";t.d(n,{Ho:function(){return c},Eu:function(){return i}});var r=t(67294),a=t(85893),s=r.createContext(void 0),c=function(e){var n=e.auth;return(0,a.jsx)(s.Provider,{value:n,children:e.children})},i=function(){return r.useContext(s)}},55024:function(){}}]);